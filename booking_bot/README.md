# Telegram Booking Bot

Бот для бронирования столиков в ресторане с системой напоминаний.

## Новые функции

### 1. Выбор количества гостей
- Клиенты могут выбрать количество гостей от 1 до 8 человек
- Информация о количестве гостей сохраняется в базе данных
- Администраторы видят количество гостей в уведомлениях

### 2. Настройка напоминаний
- Клиенты могут выбрать время напоминания:
  - За 1 час
  - За 2 часа (по умолчанию)
  - За 3 часа
  - За 6 часов
  - За 12 часов
  - За 24 часа
  - Без напоминания
- Каждое бронирование может иметь индивидуальные настройки напоминаний

### 3. Информация о столиках
- Администраторы могут добавлять примечания к столикам (например, "у окна", "на террасе")
- Клиенты видят эту информацию при выборе времени
- Примечания отображаются в скобках рядом со временем

## Команды администратора

### Существующие команды:
- `/addslot YYYY-MM-DD HH:MM [длительность_мин] [примечание]` - добавить слот
- `/addslots YYYY-MM-DD HH:MM [HH:MM ...] [длительность_мин]` - добавить несколько слотов
- `/listfree [YYYY-MM-DD]` - показать свободные слоты
- `/listbookings [YYYY-MM-DD]` - показать все бронирования
- `/delslot SLOT_ID` - удалить слот

### Новые команды:
- `/addnote SLOT_ID примечание` - добавить/изменить примечание к столику

## Примеры использования

### Добавление столика с примечанием:
```
/addslot 2024-01-15 19:00 90 у окна
```

### Добавление примечания к существующему столику:
```
/addnote 123 на террасе
```

## Процесс бронирования

1. Клиент выбирает дату
2. Клиент выбирает время (видит примечания о столике)
3. Клиент выбирает количество гостей (1-8)
4. Клиент настраивает напоминание
5. Клиент подтверждает бронирование
6. Бот отправляет подтверждение клиенту и уведомление администраторам

## Установка и запуск

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Настройте конфигурацию:
   - Скопируйте `env_example.txt` в `.env`
   - Заполните `BOT_TOKEN` (получите у @BotFather)
   - Укажите `ADMIN_IDS` (ваши Telegram ID через запятую)
   - При необходимости измените `DATABASE_PATH` (по умолчанию `./bot.db`)

3. Протестируйте базу данных (опционально):
```bash
python test_db.py
```

4. Запустите бота:
```bash
python main.py
```

## Решение проблем

### Ошибка "attempt to write a readonly database"
Эта ошибка возникает, если у процесса нет прав на запись в директорию с базой данных. Решения:

1. **Измените путь к базе данных** в `.env`:
   ```
   DATABASE_PATH=./bot.db
   ```

2. **Убедитесь, что у процесса есть права на запись** в директорию

3. **Проверьте права доступа к файлу базы данных**:
   ```bash
   chmod 644 bot.db
   ```